<!DOCTYPE html>
<html lang="ko">
<head>
  <!-- Use correct character set. -->
  <meta charset="utf-8">
  <!-- Tell IE to use the latest, best version. -->
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <!-- Make the application on mobile take up the full browser screen and disable user scaling. -->
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, minimum-scale=1, user-scalable=no">
  <title>GangWon Open-Pit Mine Monitoring System</title>
  <link href="lib/jquery-ui.css" rel="stylesheet" type="text/css" />
  <style>
  html, body {width: 100%; height: 100%; margin: 0; padding: 0; overflow: hidden; }
  #header {height: 80px; width:100%; color:#FFF; text-align:center; background-color:#333; }
  #header h1 {font-family:"Arial"; text-shadow: 0.1em 0.1em 0.15em #DDD; padding-top:10px; margin:0;}
  #header h4 {font-family:"맑은 고딕"; text-shadow: 0.1em 0.1em 0.15em #DDD; margin:0;}
  #wrap {width:100%; min-width:1000px; height:90%; overflow:hidden; }
  #leftCesium {width:50%; height:100%; position:relative; float:left; background-color:#0F0; }
  #rightCesium {width:50%; height:100%; position:relative; float:left; background-color:#00F; }
  
  .uiBox h1 {
    height:15px; width:370px;
    margin:0 0 8px 0; padding:0 0 7px 0;
    border-bottom:1px solid #999;
    font-size:1.0em; color: #ea4;
    opacity:1.0;
  }
  .uiBox {
    position:absolute; 
    top:10px; left:10px; width:400px; height:120px;
    background-color: #333; border-radius: 7px;
    box-shadow: 2px 2px 3px #888;
  }
  .uiBox button {border-radius: 4px; font-family:"맑은 고딕"; font-size: 13px;}
  #leftYearHandle, #rightYearHandle {
    width: 30px; height: 15px; line-height: 1.6em;
    top: 50%; margin-top: -8px; margin-left: -15px;
    text-align: center; font-size: 10px; 
  }
  .ui-slider-horizontal {height:2px; }
  .sliderText {
    position:relative; width:50px; height: 50px; float:left;
    font-family:"맑은 고딕"; font-size: 12px; text-shadow: 0 0 0.2em #FFF, 0 0 0.2em #FFF, 0 0 0.2em #FFF;
  }
  .sliderBox {
    position:relative; left:15px; width:300px; height: 10px; float:left; vertical-align:middle;
  }
  .photoYears {position:relative;}
  .yearSlider {position:absolute; top:53px; left:55px; width:300px;}
  .buttonBox {width: 380px;}
  
  </style>

  <script src="lib/jquery-1.12.3.min.js" type="text/javascript"></script>
	<script src="lib/jquery-ui.js" type="text/javascript"></script>
  <script>
  // On Init
  $( function(){
    initDivSize();
    initSlider([2007,2008,2010,2013,2014,2015,2016], [2007,2014,2015,2016]);
  });
  
  // On Resize
  $(window).resize(initDivSize);
  
  // set divs size
  function initDivSize() {
    var fullHeight = $(document).height();
    var fullWidth = $(document).width();
    var mapWidth = Math.floor(fullWidth / 2);
    var mapHeight = fullHeight - $("#header").height();
    
    $("#wrap").height(mapHeight);
    $("#leftCesium").width(mapWidth);
    $("#rightCesium").width(mapWidth);
  }
  
  function initSlider(photoYearArray, demYearArray) {
    var minYear = Math.min(Math.min.apply(Math, photoYearArray), Math.min.apply(Math, demYearArray));
    var maxYear = Math.min(Math.max.apply(Math, photoYearArray), Math.max.apply(Math, demYearArray));
    
    var fullYears = photoYearArray;
    $.each(demYearArray, function(i, el){
      if ($.inArray(el, fullYears) === -1) fullYears.push(el);
    });
    fullYears = fullYears.sort();
    var secondIndex = fullYears.length - 2;
    if (secondIndex < 0) secondIndex = 0;
    var secondYear = fullYears[secondIndex];
    
    var leftHandle = $("#leftYearHandle");
    $("#leftYear").slider({
      min: minYear,
      max: maxYear,
      value: maxYear,
      step: 1,
      create: function() {
        leftHandle.text($(this).slider("value"));
      },
      slide: function(event, ui) {
        leftHandle.text(ui.value);
      }
    });
    var rightHandle = $("#rightYearHandle");
    $("#rightYear").slider({
      min: minYear,
      max: maxYear,
      value: secondYear,
      step: 1,
      create: function() {
        rightHandle.text($(this).slider("value"));
      },
      slide: function(event, ui) {
        rightHandle.text(ui.value);
      }
    });
    
    var canvasList = document.getElementsByTagName("canvas");
    for (var i=0; canvasList.length; i++) {
      var canvas = canvasList[i];
      if (canvas == null || canvas.getContext == null) return;
      var ctx = canvas.getContext("2d");
      ctx.fillStyle="yellow";
      ctx.strokeStyle="yellow";
      ctx.font='11px "맑은 고딕"';
      ctx.fillText("영상년도:", 0,12, 40);
      ctx.fillText("DEM년도:", 0,51, 40);
      ctx.font='8px "맑은 고딕"';
      
      ctx.fillStyle="#FFF";
      ctx.strokeStyle="#FFF";
      var delta = 300.0/(maxYear-minYear);
      var y = 10;
      for (var year=minYear, x=45; year<=maxYear; year++, x += delta) {
        if (photoYearArray.indexOf(year) >= 0) {
          ctx.fillText(year, x,y, 30);
          ctx.moveTo(x+11,y+5);
          ctx.lineTo(x+11,y+15);
          ctx.stroke();
        }
      }

      y = 50;
      for (var year=minYear, x=45; year<=maxYear; year++, x += delta) {
        if (demYearArray.indexOf(year) >= 0) {
          ctx.fillText(year, x,y, 30);
          ctx.moveTo(x+11,y-10);
          ctx.lineTo(x+11,y-25);
          ctx.stroke();
        }
      }
    }
  }
  </script>
</header>
<body>
  <div id="header">
    <h1>GangWon Open-Pit Mine Monitoring System</h1>
    <h4> - 상지대학교 지형정보연구실 - </h4>
  </div>
  <div id="wrap">
    <div id="leftCesium">
      <div class="uiBox">
        <div class="sliderBox">
          <h1>라파즈 한라시멘트 - 가행광산</h1>
          <canvas class="photoYears" width="370" height="55"></canvas >
          <div id="leftYear" class="yearSlider">
            <div id="leftYearHandle" class="ui-slider-handle"></div>
          </div>
          <div class="buttonBox">
            <button>영상보기</button>
            <button>영상변화분석</button>
            <button>지형변화분석</button>
            <button>변화지역보기</button>
          </div>
        </div>
      </div>
    </div>
    <div id="rightCesium">
      <div class="uiBox">
        <div class="sliderBox">
          <h1>라파즈 한라시멘트 - 가행광산</h1>
          <canvas class="photoYears" width="370" height="55"></canvas >
          <div id="rightYear" class="yearSlider">
            <div id="rightYearHandle" class="ui-slider-handle"></div>
          </div>
          <div class="buttonBox">
            <button>영상보기</button>
            <button>영상변화분석</button>
            <button>지형변화분석</button>
            <button>변화지역보기</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</body>